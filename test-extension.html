<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market X-Ray Extension Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #0F1115;
            color: #EAECEF;
        }
        .test-section {
            margin: 40px 0;
            padding: 24px;
            border: 1px solid #2A2D32;
            border-radius: 12px;
            background: #1A1D21;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }
        .ticker-example {
            font-size: 18px;
            margin: 12px 0;
            padding: 14px;
            background: #2A2D32;
            border-radius: 8px;
            border: 1px solid #3A3D42;
            transition: all 0.2s ease;
        }
        .ticker-example:hover {
            border-color: #FF6B35;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.2);
        }
        .status {
            padding: 12px;
            border-radius: 8px;
            margin: 12px 0;
            border-left: 4px solid;
        }
        .status.success {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            border-left-color: #4CAF50;
        }
        .status.error {
            background: rgba(255, 107, 107, 0.1);
            color: #FF6B6B;
            border-left-color: #FF6B6B;
        }
        .status.info {
            background: rgba(139, 148, 158, 0.1);
            color: #8B949E;
            border-left-color: #8B949E;
        }
        .status.warning {
            background: rgba(255, 107, 53, 0.1);
            color: #FF6B35;
            border-left-color: #FF6B35;
        }
        code {
            background: #2A2D32;
            color: #FF6B35;
            padding: 3px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        h1, h2, h3 {
            color: #FFFFFF;
        }
        h1 {
            border-bottom: 2px solid #FF6B35;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #FF6B35;
            margin-top: 0;
        }
        button {
            background: linear-gradient(135deg, #2A2D32 0%, #1E2125 100%);
            color: #D1D5DB;
            border: 1px solid #3A3D42;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 5px;
        }
        button:hover {
            background: linear-gradient(135deg, #3A3D42 0%, #2A2D32 100%);
            border-color: #FF6B35;
            color: #FF6B35;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
        }
        button:active {
            transform: translateY(0);
        }
        .premium-button {
            background: linear-gradient(135deg, #5865F2 0%, #4752C4 100%);
            color: #FFFFFF;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.2s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(88, 101, 242, 0.2);
        }
        .premium-button:hover {
            background: linear-gradient(135deg, #4752C4 0%, #3C45A5 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 16px rgba(88, 101, 242, 0.3);
        }
        .premium-button:active {
            transform: translateY(0) scale(0.98);
        }
        .design-preview {
            background: #0F1115;
            border: 1px solid #2A2D32;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }
        .color-swatch {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 8px;
            vertical-align: middle;
            border: 1px solid #2A2D32;
        }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #2A2D32;
            display: flex;
            align-items: center;
        }
        .feature-list li:before {
            content: "âœ“";
            color: #4CAF50;
            font-weight: bold;
            margin-right: 10px;
        }
        .visual-guide {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .visual-item {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            background: #1E2125;
            border-radius: 8px;
            border: 1px solid #2A2D32;
        }
    </style>
</head>
<body>
    <h1>ğŸ¨ Market X-Ray - Premium Dark Theme</h1>

    <div class="test-section">
        <h2>ğŸš€ å…¨æ–°è®¾è®¡äº®ç‚¹</h2>
        <div class="visual-guide">
            <div class="visual-item">
                <h3>ğŸ¯ é¶å¿ƒè¿›åº¦æ¡</h3>
                <p>Max Pain åœ¨ä¸­é—´ï¼Œç°ä»·åƒæ¸¸æ ‡ä¸€æ ·ç§»åŠ¨ï¼Œä¸€çœ¼çœ‹å‡ºåç¦»ç¨‹åº¦ã€‚</p>
                <div class="color-swatch" style="background: #FF6B35;"></div> Max Pain è­¦å‘Šè‰²
            </div>
            <div class="visual-item">
                <h3>ğŸŒ™ æ·±è‰²ä¸»é¢˜</h3>
                <p>ä¸“ä¸šæš—é»‘ç•Œé¢ï¼Œå‡å°‘è§†è§‰ç–²åŠ³ï¼Œå¢å¼ºæ•°æ®å¯è¯»æ€§ã€‚</p>
                <div class="color-swatch" style="background: #0F1115;"></div> èƒŒæ™¯è‰²
                <div class="color-swatch" style="background: #EAECEF;"></div> æ–‡å­—è‰²
            </div>
            <div class="visual-item">
                <h3>ğŸ¤– Discordç¤¾åŒºå…¥å£</h3>
                <p>Discordé£æ ¼æŒ‰é’®ï¼Œç‚¹å‡»åŠ å…¥æˆ‘ä»¬çš„äº¤æ˜“ç¤¾åŒºã€‚</p>
                <button class="premium-button" id="discordButton">
                    <img src="icons/Discord.svg" width="20" height="20" alt="Discord" style="filter: brightness(0) invert(1);">
                    Join Discord
                </button>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“‹ å®‰è£…æŒ‡å—</h2>
        <ol>
            <li>æ‰“å¼€ Chrome å¹¶è®¿é—® <code>chrome://extensions/</code></li>
            <li>å¼€å¯å³ä¸Šè§’çš„ <strong>"å¼€å‘è€…æ¨¡å¼"</strong></li>
            <li>ç‚¹å‡» <strong>"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"</strong></li>
            <li>é€‰æ‹©é¡¹ç›®ä¸­çš„ <code>chrome-extension</code> æ–‡ä»¶å¤¹</li>
            <li>æ‰©å±•åº”è¯¥å‡ºç°åœ¨æ‰©å±•åˆ—è¡¨ä¸­</li>
            <li>ä½¿ç”¨ä¸‹é¢çš„ç¤ºä¾‹å†…å®¹æµ‹è¯•æ‰©å±•</li>
        </ol>
        <div class="status warning">
            ğŸ’¡ <strong>æç¤ºï¼š</strong> å¦‚æœä¹‹å‰åŠ è½½å¤±è´¥ï¼Œè¯·å…ˆç§»é™¤æ—§æ‰©å±•å†é‡æ–°åŠ è½½ã€‚
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ§ª æµ‹è¯•è‚¡ç¥¨ä»£ç æ£€æµ‹</h2>
        <p>å°†é¼ æ ‡æ‚¬åœåœ¨ä¸‹é¢çš„è‚¡ç¥¨ä»£ç ä¸Šï¼ŒæŸ¥çœ‹æ–°çš„ Market X-Ray å·¥å…·æç¤ºï¼š</p>

        <div class="ticker-example">
            <p>åˆšåˆšåŠ ä»“äº† <strong style="color: #FF6B35;">$AAPL</strong>ï¼è´¢æŠ¥è¡¨ç°å¾ˆæ‰å®ï¼</p>
        </div>

        <div class="ticker-example">
            <p>è€ƒè™‘æŠŠ <strong style="color: #FF6B35;">$TSLA</strong> åŠ å…¥æŠ•èµ„ç»„åˆã€‚å¤§å®¶æ€ä¹ˆçœ‹ <strong style="color: #FF6B35;">$NVDA</strong>ï¼Ÿ</p>
        </div>

        <div class="ticker-example">
            <p>å¸‚åœºæ›´æ–°ï¼š<strong style="color: #FF6B35;">$SPY</strong> ä¸Šæ¶¨ 1.5%ï¼Œ<strong style="color: #FF6B35;">$QQQ</strong> ä¸Šæ¶¨ 2.1%ã€‚</p>
        </div>

        <div class="ticker-example">
            <p>è¿™å‘¨é‡ç‚¹å…³æ³¨ <strong style="color: #FF6B35;">$MSFT</strong> å’Œ <strong style="color: #FF6B35;">$GOOGL</strong>ã€‚</p>
        </div>

        <div class="status info">
            ğŸ’¡ <strong>æç¤ºï¼š</strong> å®‰è£…æ‰©å±•åï¼Œå°†é¼ æ ‡æ‚¬åœåœ¨ <code>$AAPL</code> æˆ– <code>$TSLA</code> ä¸Šï¼Œåº”è¯¥ä¼šå‡ºç°æ·±è‰²ä¸»é¢˜çš„å·¥å…·æç¤ºã€‚
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ”§ API è¿æ¥æµ‹è¯•</h2>
        <p>ç›´æ¥æµ‹è¯• Cloudflare Worker APIï¼š</p>
        <div id="api-test-results">
            <div class="status info">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æµ‹è¯• API è¿æ¥...</div>
        </div>
        <button onclick="testHealth()">ğŸ©º æµ‹è¯•å¥åº·æ£€æŸ¥</button>
        <button onclick="testAAPL()">ğŸ æµ‹è¯• AAPL Max Pain</button>
        <button onclick="testTSLA()">ğŸš— æµ‹è¯• TSLA Max Pain</button>
        <button onclick="testAll()">ğŸš€ ä¸€é”®å…¨é¢æµ‹è¯•</button>
    </div>

    <div class="test-section">
        <h2>âœ… é¢„æœŸç»“æœ</h2>
        <ul class="feature-list">
            <li><strong>æ‰©å±•æˆåŠŸåŠ è½½</strong> - Chrome ä¸­æ²¡æœ‰é”™è¯¯ä¿¡æ¯</li>
            <li><strong>å·¥å…·æç¤ºæ­£å¸¸æ˜¾ç¤º</strong> - æ‚¬åœåœ¨è‚¡ç¥¨ä»£ç ä¸Šå‡ºç°æ·±è‰²ä¸»é¢˜å·¥å…·æç¤º</li>
            <li><strong>API è°ƒç”¨æ­£å¸¸</strong> - èƒ½å¤Ÿè·å– Max Pain æ•°æ®</li>
            <li><strong>æ— æ§åˆ¶å°é”™è¯¯</strong> - Chrome DevTools ä¸­æ²¡æœ‰çº¢è‰²é”™è¯¯</li>
            <li><strong>æ–°è®¾è®¡æ•ˆæœ</strong> - æ·±è‰²ä¸»é¢˜ã€é¶å¿ƒè¿›åº¦æ¡ã€ç¨€ç¼ºæ„ŸæŒ‰é’®</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>ğŸ” æ•…éšœæ’é™¤</h2>
        <p>å¦‚æœæ‰©å±•ä¸å·¥ä½œï¼š</p>
        <ul class="feature-list">
            <li>æ£€æŸ¥ Chrome DevTools æ§åˆ¶å°ï¼ˆæŒ‰ F12ï¼‰æ˜¯å¦æœ‰é”™è¯¯</li>
            <li>ç¡®è®¤æ‰©å±•åœ¨ <code>chrome://extensions/</code> ä¸­å·²å¯ç”¨</li>
            <li>ç¡®ä¿ API å¯è®¿é—®ï¼š<a href="https://market-x-ray-worker.chenkaijie02.workers.dev/health" target="_blank" style="color: #FF6B35;">https://market-x-ray-worker.chenkaijie02.workers.dev/health</a></li>
            <li>æ£€æŸ¥ manifest.json ä¸­çš„ host_permissions æ˜¯å¦æ­£ç¡®</li>
            <li>å¦‚æœä¹‹å‰åŠ è½½å¤±è´¥ï¼Œå…ˆç§»é™¤æ—§æ‰©å±•å†é‡æ–°åŠ è½½</li>
        </ul>
        <div class="status warning">
            âš ï¸ <strong>å¸¸è§é—®é¢˜ï¼š</strong> å¦‚æœçœ‹åˆ° "Could not load icon" é”™è¯¯ï¼Œè¯·ç¡®ä¿å·²æŒ‰ç…§å‰é¢çš„æ­¥éª¤ä¿®å¤äº†å›¾æ ‡æ–‡ä»¶ã€‚
        </div>
    </div>

    <script>
        const API_BASE = 'https://market-x-ray-worker-production.chenkaijie02.workers.dev';

        function testHealth() {
            const results = document.getElementById('api-test-results');
            results.innerHTML = '<div class="status info">ğŸ©º æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹...</div>';

            fetch(`${API_BASE}/health`)
                .then(response => response.json())
                .then(data => {
                    results.innerHTML = `
                        <div class="status success">
                            âœ… <strong>å¥åº·æ£€æŸ¥é€šè¿‡ï¼</strong><br>
                            ğŸ¥ çŠ¶æ€: ${data.status}<br>
                            ğŸ”§ æœåŠ¡: ${data.service}<br>
                            ğŸ• æ—¶é—´: ${new Date(data.timestamp).toLocaleString()}<br>
                            ğŸŒ API ç«¯ç‚¹: ${API_BASE}
                        </div>
                    `;
                })
                .catch(error => {
                    results.innerHTML = `
                        <div class="status error">
                            âŒ <strong>å¥åº·æ£€æŸ¥å¤±è´¥ï¼</strong><br>
                            âš ï¸ é”™è¯¯: ${error.message}<br>
                            ğŸ”— è¯·æ£€æŸ¥: <a href="${API_BASE}/health" target="_blank" style="color: #FF6B6B;">${API_BASE}/health</a>
                        </div>
                    `;
                });
        }

        function testAAPL() {
            const results = document.getElementById('api-test-results');
            results.innerHTML = '<div class="status info">ğŸ æµ‹è¯• AAPL Max Pain æ•°æ®...</div>';

            fetch(`${API_BASE}/api/max-pain/AAPL`)
                .then(response => response.json())
                .then(data => {
                    const diffColor = data.analysis.difference > 0 ? '#4CAF50' : '#FF6B6B';
                    const diffIcon = data.analysis.difference > 0 ? 'ğŸ“ˆ' : 'ğŸ“‰';

                    results.innerHTML = `
                        <div class="status success">
                            âœ… <strong>AAPL Max Pain æ•°æ®æ¥æ”¶æˆåŠŸï¼</strong><br>
                            ğŸ·ï¸ ä»£ç : ${data.symbol}<br>
                            ğŸ’° ç°ä»·: <strong style="color: #FFFFFF;">$${data.underlyingPrice.toFixed(2)}</strong><br>
                            ğŸ¯ Max Pain: <strong style="color: #FF6B35;">$${data.maxPain.toFixed(2)}</strong><br>
                            ${diffIcon} åç¦»: <strong style="color: ${diffColor};">$${data.analysis.difference.toFixed(2)} (${data.analysis.percentageDiff}%)</strong><br>
                            ğŸ­ æƒ…ç»ª: <span style="color: ${getSentimentColor(data.analysis.sentiment)};">${data.analysis.sentiment}</span><br>
                            ğŸ“¦ ç¼“å­˜: ${data.cached ? 'æ˜¯ âœ…' : 'å¦ âš¡'}
                        </div>
                    `;
                })
                .catch(error => {
                    results.innerHTML = `
                        <div class="status error">
                            âŒ <strong>AAPL Max Pain æµ‹è¯•å¤±è´¥ï¼</strong><br>
                            âš ï¸ é”™è¯¯: ${error.message}<br>
                            ğŸ”— è¯·æ£€æŸ¥: <a href="${API_BASE}/api/max-pain/AAPL" target="_blank" style="color: #FF6B6B;">${API_BASE}/api/max-pain/AAPL</a>
                        </div>
                    `;
                });
        }

        function testTSLA() {
            const results = document.getElementById('api-test-results');
            results.innerHTML = '<div class="status info">ğŸš— æµ‹è¯• TSLA Max Pain æ•°æ®...</div>';

            fetch(`${API_BASE}/api/max-pain/TSLA`)
                .then(response => response.json())
                .then(data => {
                    const diffColor = data.analysis.difference > 0 ? '#4CAF50' : '#FF6B6B';
                    const diffIcon = data.analysis.difference > 0 ? 'ğŸ“ˆ' : 'ğŸ“‰';

                    results.innerHTML = `
                        <div class="status success">
                            âœ… <strong>TSLA Max Pain æ•°æ®æ¥æ”¶æˆåŠŸï¼</strong><br>
                            ğŸ·ï¸ ä»£ç : ${data.symbol}<br>
                            ğŸ’° ç°ä»·: <strong style="color: #FFFFFF;">$${data.underlyingPrice.toFixed(2)}</strong><br>
                            ğŸ¯ Max Pain: <strong style="color: #FF6B35;">$${data.maxPain.toFixed(2)}</strong><br>
                            ${diffIcon} åç¦»: <strong style="color: ${diffColor};">$${data.analysis.difference.toFixed(2)} (${data.analysis.percentageDiff}%)</strong><br>
                            ğŸ­ æƒ…ç»ª: <span style="color: ${getSentimentColor(data.analysis.sentiment)};">${data.analysis.sentiment}</span><br>
                            ğŸ“¦ ç¼“å­˜: ${data.cached ? 'æ˜¯ âœ…' : 'å¦ âš¡'}
                        </div>
                    `;
                })
                .catch(error => {
                    results.innerHTML = `
                        <div class="status error">
                            âŒ <strong>TSLA Max Pain æµ‹è¯•å¤±è´¥ï¼</strong><br>
                            âš ï¸ é”™è¯¯: ${error.message}<br>
                            ğŸ”— è¯·æ£€æŸ¥: <a href="${API_BASE}/api/max-pain/TSLA" target="_blank" style="color: #FF6B6B;">${API_BASE}/api/max-pain/TSLA</a>
                        </div>
                    `;
                });
        }

        function testAll() {
            const results = document.getElementById('api-test-results');
            results.innerHTML = '<div class="status info">ğŸš€ å¼€å§‹å…¨é¢æµ‹è¯•...</div>';

            let healthPassed = false;
            let aaplPassed = false;
            let tslaPassed = false;

            // Test health
            fetch(`${API_BASE}/health`)
                .then(response => response.json())
                .then(healthData => {
                    healthPassed = true;

                    // Test AAPL
                    return fetch(`${API_BASE}/api/max-pain/AAPL`);
                })
                .then(response => response.json())
                .then(aaplData => {
                    aaplPassed = true;

                    // Test TSLA
                    return fetch(`${API_BASE}/api/max-pain/TSLA`);
                })
                .then(response => response.json())
                .then(tslaData => {
                    tslaPassed = true;

                    results.innerHTML = `
                        <div class="status success">
                            ğŸ‰ <strong>å…¨é¢æµ‹è¯•é€šè¿‡ï¼</strong><br>
                            âœ… å¥åº·æ£€æŸ¥: é€šè¿‡<br>
                            âœ… AAPL æ•°æ®: é€šè¿‡ (ç°ä»·: $${aaplData.underlyingPrice.toFixed(2)})<br>
                            âœ… TSLA æ•°æ®: é€šè¿‡ (ç°ä»·: $${tslaData.underlyingPrice.toFixed(2)})<br>
                            <br>
                            ğŸš€ <strong>æ‰€æœ‰ç³»ç»Ÿæ­£å¸¸ï¼Œå¯ä»¥å®‰è£…æ‰©å±•ï¼</strong>
                        </div>
                    `;
                })
                .catch(error => {
                    results.innerHTML = `
                        <div class="status ${healthPassed && aaplPassed ? 'warning' : 'error'}">
                            ${healthPassed && aaplPassed ? 'âš ï¸' : 'âŒ'} <strong>éƒ¨åˆ†æµ‹è¯•å¤±è´¥</strong><br>
                            ${healthPassed ? 'âœ…' : 'âŒ'} å¥åº·æ£€æŸ¥: ${healthPassed ? 'é€šè¿‡' : 'å¤±è´¥'}<br>
                            ${aaplPassed ? 'âœ…' : 'âŒ'} AAPL æ•°æ®: ${aaplPassed ? 'é€šè¿‡' : 'å¤±è´¥'}<br>
                            ${tslaPassed ? 'âœ…' : 'âŒ'} TSLA æ•°æ®: ${tslaPassed ? 'é€šè¿‡' : 'å¤±è´¥'}<br>
                            <br>
                            âš ï¸ é”™è¯¯: ${error.message}
                        </div>
                    `;
                });
        }

        function getSentimentColor(sentiment) {
            switch(sentiment) {
                case 'bearish': return '#FF6B6B';
                case 'slightly bearish': return '#FFA726';
                case 'bullish': return '#4CAF50';
                case 'slightly bullish': return '#9C27B0';
                default: return '#8B949E';
            }
        }

        // Auto-test on page load
        window.addEventListener('load', () => {
            setTimeout(testHealth, 500);

            // Add Discord button click handler
            const discordButton = document.getElementById('discordButton');
            if (discordButton) {
                discordButton.addEventListener('click', () => {
                    window.open('https://discord.gg/FHvSUTUuMU', '_blank');
                });
            }
        });
    </script>
</body>
</html>